'use client';
import*as e from"react";import{composeEventHandlers as t}from"../../../../../@radix-ui_primitive@1.1.3/node_modules/@radix-ui/primitive/dist/index.mjs.js";import{Primitive as n,dispatchDiscreteCustomEvent as r}from"../../../../../@radix-ui_react-primitive@2_8827551f88f8a44c5b480e0d8a5a4518/node_modules/@radix-ui/react-primitive/dist/index.mjs.js";import{useComposedRefs as s}from"../../../../../@radix-ui_react-compose-ref_531e21d4c5e41774790b7ade2915befe/node_modules/@radix-ui/react-compose-refs/dist/index.mjs.js";import{useCallbackRef as i}from"../../../../../@radix-ui_react-use-callbac_1832c4945613a7ff78753a717fc0f760/node_modules/@radix-ui/react-use-callback-ref/dist/index.mjs.js";import{useEscapeKeydown as o}from"../../../../../@radix-ui_react-use-escape-_cb8f2762255ff4457593d29341aaf6aa/node_modules/@radix-ui/react-use-escape-keydown/dist/index.mjs.js";import{jsx as a}from"react/jsx-runtime";var u,d="dismissableLayer.update",c="dismissableLayer.pointerDownOutside",l="dismissableLayer.focusOutside",f=e.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),m=e.forwardRef((r,m)=>{const{disableOutsidePointerEvents:v=!1,onEscapeKeyDown:b,onPointerDownOutside:y,onFocusOutside:w,onInteractOutside:x,onDismiss:h,...D}=r,C=e.useContext(f),[L,P]=e.useState(null),O=L?.ownerDocument??globalThis?.document,[,_]=e.useState({}),g=s(m,e=>P(e)),j=Array.from(C.layers),[W]=[...C.layersWithOutsidePointerEventsDisabled].slice(-1),k=j.indexOf(W),R=L?j.indexOf(L):-1,T=C.layersWithOutsidePointerEventsDisabled.size>0,B=R>=k,F=function(t,n=globalThis?.document){const r=i(t),s=e.useRef(!1),o=e.useRef(()=>{});return e.useEffect(()=>{const e=e=>{if(e.target&&!s.current){let t=function(){E(c,r,s,{discrete:!0})};const s={originalEvent:e};"touch"===e.pointerType?(n.removeEventListener("click",o.current),o.current=t,n.addEventListener("click",o.current,{once:!0})):t()}else n.removeEventListener("click",o.current);s.current=!1},t=window.setTimeout(()=>{n.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(t),n.removeEventListener("pointerdown",e),n.removeEventListener("click",o.current)}},[n,r]),{onPointerDownCapture:()=>s.current=!0}}(e=>{const t=e.target,n=[...C.branches].some(e=>e.contains(t));B&&!n&&(y?.(e),x?.(e),e.defaultPrevented||h?.())},O),S=function(t,n=globalThis?.document){const r=i(t),s=e.useRef(!1);return e.useEffect(()=>{const e=e=>{if(e.target&&!s.current){E(l,r,{originalEvent:e},{discrete:!1})}};return n.addEventListener("focusin",e),()=>n.removeEventListener("focusin",e)},[n,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}(e=>{const t=e.target;[...C.branches].some(e=>e.contains(t))||(w?.(e),x?.(e),e.defaultPrevented||h?.())},O);return o(e=>{R===C.layers.size-1&&(b?.(e),!e.defaultPrevented&&h&&(e.preventDefault(),h()))},O),e.useEffect(()=>{if(L)return v&&(0===C.layersWithOutsidePointerEventsDisabled.size&&(u=O.body.style.pointerEvents,O.body.style.pointerEvents="none"),C.layersWithOutsidePointerEventsDisabled.add(L)),C.layers.add(L),p(),()=>{v&&1===C.layersWithOutsidePointerEventsDisabled.size&&(O.body.style.pointerEvents=u)}},[L,O,v,C]),e.useEffect(()=>()=>{L&&(C.layers.delete(L),C.layersWithOutsidePointerEventsDisabled.delete(L),p())},[L,C]),e.useEffect(()=>{const e=()=>_({});return document.addEventListener(d,e),()=>document.removeEventListener(d,e)},[]),a(n.div,{...D,ref:g,style:{pointerEvents:T?B?"auto":"none":void 0,...r.style},onFocusCapture:t(r.onFocusCapture,S.onFocusCapture),onBlurCapture:t(r.onBlurCapture,S.onBlurCapture),onPointerDownCapture:t(r.onPointerDownCapture,F.onPointerDownCapture)})});m.displayName="DismissableLayer";var v=e.forwardRef((t,r)=>{const i=e.useContext(f),o=e.useRef(null),u=s(r,o);return e.useEffect(()=>{const e=o.current;if(e)return i.branches.add(e),()=>{i.branches.delete(e)}},[i.branches]),a(n.div,{...t,ref:u})});function p(){const e=new CustomEvent(d);document.dispatchEvent(e)}function E(e,t,n,{discrete:s}){const i=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),s?r(i,o):i.dispatchEvent(o)}v.displayName="DismissableLayerBranch";export{m as DismissableLayer,v as DismissableLayerBranch};
//# sourceMappingURL=index.mjs.js.map
