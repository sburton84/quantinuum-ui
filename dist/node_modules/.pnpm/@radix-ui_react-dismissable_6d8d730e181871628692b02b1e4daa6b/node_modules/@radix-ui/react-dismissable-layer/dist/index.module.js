import e from"../../../../../@babel_runtime@7.28.6/node_modules/@babel/runtime/helpers/esm/extends.js";import{forwardRef as t,useContext as n,useState as r,useEffect as s,createElement as i,useRef as o,createContext as d}from"react";import{composeEventHandlers as u}from"../../../../../@radix-ui_primitive@1.0.0/node_modules/@radix-ui/primitive/dist/index.module.js";import{Primitive as a,dispatchDiscreteCustomEvent as c}from"../../../../../@radix-ui_react-primitive@1_41630aba69d583ccfbdcce925a3bb340/node_modules/@radix-ui/react-primitive/dist/index.module.js";import{useComposedRefs as l}from"../../../../../@radix-ui_react-compose-refs@1.0.0_react@18.3.1/node_modules/@radix-ui/react-compose-refs/dist/index.module.js";import{useCallbackRef as m}from"../../../../../@radix-ui_react-use-callback-ref@1.0.0_react@18.3.1/node_modules/@radix-ui/react-use-callback-ref/dist/index.module.js";import{useEscapeKeydown as p}from"../../../../../@radix-ui_react-use-escape-keydown@1.0.0_react@18.3.1/node_modules/@radix-ui/react-use-escape-keydown/dist/index.module.js";const v="dismissableLayer.update",b="dismissableLayer.pointerDownOutside",f="dismissableLayer.focusOutside";let E;const y=d({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),w=t((t,d)=>{const{disableOutsidePointerEvents:c=!1,onEscapeKeyDown:w,onPointerDownOutside:C,onFocusOutside:P,onInteractOutside:_,onDismiss:h,...O}=t,L=n(y),[g,k]=r(null),[,W]=r({}),j=l(d,e=>k(e)),F=Array.from(L.layers),[z]=[...L.layersWithOutsidePointerEventsDisabled].slice(-1),B=F.indexOf(z),S=g?F.indexOf(g):-1,T=L.layersWithOutsidePointerEventsDisabled.size>0,K=S>=B,R=function(e){const t=m(e),n=o(!1),r=o(()=>{});return s(()=>{const e=e=>{if(e.target&&!n.current){const s={originalEvent:e};function i(){D(b,t,s,{discrete:!0})}"touch"===e.pointerType?(document.removeEventListener("click",r.current),r.current=i,document.addEventListener("click",r.current,{once:!0})):i()}n.current=!1},s=window.setTimeout(()=>{document.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(s),document.removeEventListener("pointerdown",e),document.removeEventListener("click",r.current)}},[t]),{onPointerDownCapture:()=>n.current=!0}}(e=>{const t=e.target,n=[...L.branches].some(e=>e.contains(t));K&&!n&&(null==C||C(e),null==_||_(e),e.defaultPrevented||null==h||h())}),A=function(e){const t=m(e),n=o(!1);return s(()=>{const e=e=>{if(e.target&&!n.current){D(f,t,{originalEvent:e},{discrete:!1})}};return document.addEventListener("focusin",e),()=>document.removeEventListener("focusin",e)},[t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}(e=>{const t=e.target;[...L.branches].some(e=>e.contains(t))||(null==P||P(e),null==_||_(e),e.defaultPrevented||null==h||h())});return p(e=>{S===L.layers.size-1&&(null==w||w(e),!e.defaultPrevented&&h&&(e.preventDefault(),h()))}),s(()=>{if(g)return c&&(0===L.layersWithOutsidePointerEventsDisabled.size&&(E=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),L.layersWithOutsidePointerEventsDisabled.add(g)),L.layers.add(g),x(),()=>{c&&1===L.layersWithOutsidePointerEventsDisabled.size&&(document.body.style.pointerEvents=E)}},[g,c,L]),s(()=>()=>{g&&(L.layers.delete(g),L.layersWithOutsidePointerEventsDisabled.delete(g),x())},[g,L]),s(()=>{const e=()=>W({});return document.addEventListener(v,e),()=>document.removeEventListener(v,e)},[]),i(a.div,e({},O,{ref:j,style:{pointerEvents:T?K?"auto":"none":void 0,...t.style},onFocusCapture:u(t.onFocusCapture,A.onFocusCapture),onBlurCapture:u(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:u(t.onPointerDownCapture,R.onPointerDownCapture)}))});function x(){const e=new CustomEvent(v);document.dispatchEvent(e)}function D(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?c(s,i):s.dispatchEvent(i)}export{w as DismissableLayer};
//# sourceMappingURL=index.module.js.map
