{"version":3,"file":"SideEffect.js","sources":["../../../../../../../../node_modules/.pnpm/react-remove-scroll@2.7.2_@types+react@18.3.28_react@18.3.1/node_modules/react-remove-scroll/dist/es2015/SideEffect.js"],"sourcesContent":["import { __spreadArray } from \"tslib\";\nimport * as React from 'react';\nimport { RemoveScrollBar } from 'react-remove-scroll-bar';\nimport { styleSingleton } from 'react-style-singleton';\nimport { nonPassive } from './aggresiveCapture';\nimport { handleScroll, locationCouldBeScrolled } from './handleScroll';\nexport var getTouchXY = function (event) {\n    return 'changedTouches' in event ? [event.changedTouches[0].clientX, event.changedTouches[0].clientY] : [0, 0];\n};\nexport var getDeltaXY = function (event) { return [event.deltaX, event.deltaY]; };\nvar extractRef = function (ref) {\n    return ref && 'current' in ref ? ref.current : ref;\n};\nvar deltaCompare = function (x, y) { return x[0] === y[0] && x[1] === y[1]; };\nvar generateStyle = function (id) { return \"\\n  .block-interactivity-\".concat(id, \" {pointer-events: none;}\\n  .allow-interactivity-\").concat(id, \" {pointer-events: all;}\\n\"); };\nvar idCounter = 0;\nvar lockStack = [];\nexport function RemoveScrollSideCar(props) {\n    var shouldPreventQueue = React.useRef([]);\n    var touchStartRef = React.useRef([0, 0]);\n    var activeAxis = React.useRef();\n    var id = React.useState(idCounter++)[0];\n    var Style = React.useState(styleSingleton)[0];\n    var lastProps = React.useRef(props);\n    React.useEffect(function () {\n        lastProps.current = props;\n    }, [props]);\n    React.useEffect(function () {\n        if (props.inert) {\n            document.body.classList.add(\"block-interactivity-\".concat(id));\n            var allow_1 = __spreadArray([props.lockRef.current], (props.shards || []).map(extractRef), true).filter(Boolean);\n            allow_1.forEach(function (el) { return el.classList.add(\"allow-interactivity-\".concat(id)); });\n            return function () {\n                document.body.classList.remove(\"block-interactivity-\".concat(id));\n                allow_1.forEach(function (el) { return el.classList.remove(\"allow-interactivity-\".concat(id)); });\n            };\n        }\n        return;\n    }, [props.inert, props.lockRef.current, props.shards]);\n    var shouldCancelEvent = React.useCallback(function (event, parent) {\n        if (('touches' in event && event.touches.length === 2) || (event.type === 'wheel' && event.ctrlKey)) {\n            return !lastProps.current.allowPinchZoom;\n        }\n        var touch = getTouchXY(event);\n        var touchStart = touchStartRef.current;\n        var deltaX = 'deltaX' in event ? event.deltaX : touchStart[0] - touch[0];\n        var deltaY = 'deltaY' in event ? event.deltaY : touchStart[1] - touch[1];\n        var currentAxis;\n        var target = event.target;\n        var moveDirection = Math.abs(deltaX) > Math.abs(deltaY) ? 'h' : 'v';\n        // allow horizontal touch move on Range inputs. They will not cause any scroll\n        if ('touches' in event && moveDirection === 'h' && target.type === 'range') {\n            return false;\n        }\n        // allow drag selection (iOS); check if selection's anchorNode is the same as target or contains target\n        var selection = window.getSelection();\n        var anchorNode = selection && selection.anchorNode;\n        var isTouchingSelection = anchorNode ? anchorNode === target || anchorNode.contains(target) : false;\n        if (isTouchingSelection) {\n            return false;\n        }\n        var canBeScrolledInMainDirection = locationCouldBeScrolled(moveDirection, target);\n        if (!canBeScrolledInMainDirection) {\n            return true;\n        }\n        if (canBeScrolledInMainDirection) {\n            currentAxis = moveDirection;\n        }\n        else {\n            currentAxis = moveDirection === 'v' ? 'h' : 'v';\n            canBeScrolledInMainDirection = locationCouldBeScrolled(moveDirection, target);\n            // other axis might be not scrollable\n        }\n        if (!canBeScrolledInMainDirection) {\n            return false;\n        }\n        if (!activeAxis.current && 'changedTouches' in event && (deltaX || deltaY)) {\n            activeAxis.current = currentAxis;\n        }\n        if (!currentAxis) {\n            return true;\n        }\n        var cancelingAxis = activeAxis.current || currentAxis;\n        return handleScroll(cancelingAxis, parent, event, cancelingAxis === 'h' ? deltaX : deltaY, true);\n    }, []);\n    var shouldPrevent = React.useCallback(function (_event) {\n        var event = _event;\n        if (!lockStack.length || lockStack[lockStack.length - 1] !== Style) {\n            // not the last active\n            return;\n        }\n        var delta = 'deltaY' in event ? getDeltaXY(event) : getTouchXY(event);\n        var sourceEvent = shouldPreventQueue.current.filter(function (e) { return e.name === event.type && (e.target === event.target || event.target === e.shadowParent) && deltaCompare(e.delta, delta); })[0];\n        // self event, and should be canceled\n        if (sourceEvent && sourceEvent.should) {\n            if (event.cancelable) {\n                event.preventDefault();\n            }\n            return;\n        }\n        // outside or shard event\n        if (!sourceEvent) {\n            var shardNodes = (lastProps.current.shards || [])\n                .map(extractRef)\n                .filter(Boolean)\n                .filter(function (node) { return node.contains(event.target); });\n            var shouldStop = shardNodes.length > 0 ? shouldCancelEvent(event, shardNodes[0]) : !lastProps.current.noIsolation;\n            if (shouldStop) {\n                if (event.cancelable) {\n                    event.preventDefault();\n                }\n            }\n        }\n    }, []);\n    var shouldCancel = React.useCallback(function (name, delta, target, should) {\n        var event = { name: name, delta: delta, target: target, should: should, shadowParent: getOutermostShadowParent(target) };\n        shouldPreventQueue.current.push(event);\n        setTimeout(function () {\n            shouldPreventQueue.current = shouldPreventQueue.current.filter(function (e) { return e !== event; });\n        }, 1);\n    }, []);\n    var scrollTouchStart = React.useCallback(function (event) {\n        touchStartRef.current = getTouchXY(event);\n        activeAxis.current = undefined;\n    }, []);\n    var scrollWheel = React.useCallback(function (event) {\n        shouldCancel(event.type, getDeltaXY(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n    }, []);\n    var scrollTouchMove = React.useCallback(function (event) {\n        shouldCancel(event.type, getTouchXY(event), event.target, shouldCancelEvent(event, props.lockRef.current));\n    }, []);\n    React.useEffect(function () {\n        lockStack.push(Style);\n        props.setCallbacks({\n            onScrollCapture: scrollWheel,\n            onWheelCapture: scrollWheel,\n            onTouchMoveCapture: scrollTouchMove,\n        });\n        document.addEventListener('wheel', shouldPrevent, nonPassive);\n        document.addEventListener('touchmove', shouldPrevent, nonPassive);\n        document.addEventListener('touchstart', scrollTouchStart, nonPassive);\n        return function () {\n            lockStack = lockStack.filter(function (inst) { return inst !== Style; });\n            document.removeEventListener('wheel', shouldPrevent, nonPassive);\n            document.removeEventListener('touchmove', shouldPrevent, nonPassive);\n            document.removeEventListener('touchstart', scrollTouchStart, nonPassive);\n        };\n    }, []);\n    var removeScrollBar = props.removeScrollBar, inert = props.inert;\n    return (React.createElement(React.Fragment, null,\n        inert ? React.createElement(Style, { styles: generateStyle(id) }) : null,\n        removeScrollBar ? React.createElement(RemoveScrollBar, { noRelative: props.noRelative, gapMode: props.gapMode }) : null));\n}\nfunction getOutermostShadowParent(node) {\n    var shadowParent = null;\n    while (node !== null) {\n        if (node instanceof ShadowRoot) {\n            shadowParent = node.host;\n            node = node.host;\n        }\n        node = node.parentNode;\n    }\n    return shadowParent;\n}\n"],"names":["getTouchXY","event","changedTouches","clientX","clientY","getDeltaXY","deltaX","deltaY","extractRef","ref","current","generateStyle","id","concat","idCounter","lockStack","RemoveScrollSideCar","props","shouldPreventQueue","React","useRef","touchStartRef","activeAxis","useState","Style","styleSingleton","lastProps","useEffect","inert","document","body","classList","add","allow_1","__spreadArray","lockRef","shards","map","filter","Boolean","forEach","el","remove","shouldCancelEvent","useCallback","parent","touches","length","type","ctrlKey","allowPinchZoom","currentAxis","touch","touchStart","target","moveDirection","Math","abs","selection","window","getSelection","anchorNode","contains","canBeScrolledInMainDirection","locationCouldBeScrolled","cancelingAxis","handleScroll","shouldPrevent","_event","delta","sourceEvent","e","name","shadowParent","x","y","should","cancelable","preventDefault","shardNodes","node","noIsolation","shouldCancel","getOutermostShadowParent","push","setTimeout","scrollTouchStart","undefined","scrollWheel","scrollTouchMove","setCallbacks","onScrollCapture","onWheelCapture","onTouchMoveCapture","addEventListener","nonPassive","inst","removeEventListener","removeScrollBar","createElement","Fragment","styles","RemoveScrollBar","noRelative","gapMode","ShadowRoot","host","parentNode"],"mappings":"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"}