import{__spreadArray as e}from"../../../../../tslib@2.8.1/node_modules/tslib/tslib.es6.mjs.js";import*as t from"react";import{RemoveScrollBar as n}from"../../../../../react-remove-scroll-bar@2.3_97976476ea8344d715556744aea43c42/node_modules/react-remove-scroll-bar/dist/es2015/component.js";import{styleSingleton as r}from"../../../../../react-style-singleton@2.2.3_51b1e9d6f4319a1cc9e00cf8d32b9d74/node_modules/react-style-singleton/dist/es2015/component.js";import{nonPassive as o}from"./aggresiveCapture.js";import{locationCouldBeScrolled as c,handleScroll as a}from"./handleScroll.js";var u=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},l=function(e){return[e.deltaX,e.deltaY]},i=function(e){return e&&"current"in e?e.current:e},s=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},f=0,d=[];function v(v){var m=t.useRef([]),p=t.useRef([0,0]),g=t.useRef(),b=t.useState(f++)[0],y=t.useState(r)[0],k=t.useRef(v);t.useEffect(function(){k.current=v},[v]),t.useEffect(function(){if(v.inert){document.body.classList.add("block-interactivity-".concat(b));var t=e([v.lockRef.current],(v.shards||[]).map(i),!0).filter(Boolean);return t.forEach(function(e){return e.classList.add("allow-interactivity-".concat(b))}),function(){document.body.classList.remove("block-interactivity-".concat(b)),t.forEach(function(e){return e.classList.remove("allow-interactivity-".concat(b))})}}},[v.inert,v.lockRef.current,v.shards]);var E=t.useCallback(function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!k.current.allowPinchZoom;var n,r=u(e),o=p.current,l="deltaX"in e?e.deltaX:o[0]-r[0],i="deltaY"in e?e.deltaY:o[1]-r[1],s=e.target,f=Math.abs(l)>Math.abs(i)?"h":"v";if("touches"in e&&"h"===f&&"range"===s.type)return!1;var d=window.getSelection(),v=d&&d.anchorNode;if(!!v&&(v===s||v.contains(s)))return!1;var h=c(f,s);if(!h)return!0;if(h?n=f:(n="v"===f?"h":"v",h=c(f,s)),!h)return!1;if(!g.current&&"changedTouches"in e&&(l||i)&&(g.current=n),!n)return!0;var m=g.current||n;return a(m,t,e,"h"===m?l:i,!0)},[]),w=t.useCallback(function(e){var t=e;if(d.length&&d[d.length-1]===y){var n="deltaY"in t?l(t):u(t),r=m.current.filter(function(e){return e.name===t.type&&(e.target===t.target||t.target===e.shadowParent)&&(r=e.delta,o=n,r[0]===o[0]&&r[1]===o[1]);var r,o})[0];if(r&&r.should)t.cancelable&&t.preventDefault();else if(!r){var o=(k.current.shards||[]).map(i).filter(Boolean).filter(function(e){return e.contains(t.target)});(o.length>0?E(t,o[0]):!k.current.noIsolation)&&t.cancelable&&t.preventDefault()}}},[]),C=t.useCallback(function(e,t,n,r){var o={name:e,delta:t,target:n,should:r,shadowParent:h(n)};m.current.push(o),setTimeout(function(){m.current=m.current.filter(function(e){return e!==o})},1)},[]),R=t.useCallback(function(e){p.current=u(e),g.current=void 0},[]),L=t.useCallback(function(e){C(e.type,l(e),e.target,E(e,v.lockRef.current))},[]),S=t.useCallback(function(e){C(e.type,u(e),e.target,E(e,v.lockRef.current))},[]);t.useEffect(function(){return d.push(y),v.setCallbacks({onScrollCapture:L,onWheelCapture:L,onTouchMoveCapture:S}),document.addEventListener("wheel",w,o),document.addEventListener("touchmove",w,o),document.addEventListener("touchstart",R,o),function(){d=d.filter(function(e){return e!==y}),document.removeEventListener("wheel",w,o),document.removeEventListener("touchmove",w,o),document.removeEventListener("touchstart",R,o)}},[]);var j=v.removeScrollBar,T=v.inert;return t.createElement(t.Fragment,null,T?t.createElement(y,{styles:s(b)}):null,j?t.createElement(n,{noRelative:v.noRelative,gapMode:v.gapMode}):null)}function h(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}export{v as RemoveScrollSideCar,l as getDeltaXY,u as getTouchXY};
//# sourceMappingURL=SideEffect.js.map
