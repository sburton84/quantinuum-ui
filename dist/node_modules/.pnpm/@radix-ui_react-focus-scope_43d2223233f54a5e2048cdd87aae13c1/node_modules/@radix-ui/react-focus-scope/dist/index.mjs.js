'use client';
import*as e from"react";import{useComposedRefs as t}from"../../../../../@radix-ui_react-compose-ref_531e21d4c5e41774790b7ade2915befe/node_modules/@radix-ui/react-compose-refs/dist/index.mjs.js";import{Primitive as n}from"../../../../../@radix-ui_react-primitive@2_8827551f88f8a44c5b480e0d8a5a4518/node_modules/@radix-ui/react-primitive/dist/index.mjs.js";import{useCallbackRef as o}from"../../../../../@radix-ui_react-use-callbac_1832c4945613a7ff78753a717fc0f760/node_modules/@radix-ui/react-use-callback-ref/dist/index.mjs.js";import{jsx as r}from"react/jsx-runtime";var u="focusScope.autoFocusOnMount",c="focusScope.autoFocusOnUnmount",s={bubbles:!1,cancelable:!0},i=e.forwardRef((i,f)=>{const{loop:p=!1,trapped:v=!1,onMountAutoFocus:E,onUnmountAutoFocus:b,...x}=i,[y,L]=e.useState(null),T=o(E),h=o(b),N=e.useRef(null),_=t(f,e=>L(e)),F=e.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;e.useEffect(()=>{if(v){let e=function(e){if(F.paused||!y)return;const t=e.target;y.contains(t)?N.current=t:l(N.current,{select:!0})},t=function(e){if(F.paused||!y)return;const t=e.relatedTarget;null!==t&&(y.contains(t)||l(N.current,{select:!0}))},n=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&l(y)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const o=new MutationObserver(n);return y&&o.observe(y,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),o.disconnect()}}},[v,y,F.paused]),e.useEffect(()=>{if(y){m.add(F);const t=document.activeElement;if(!y.contains(t)){const n=new CustomEvent(u,s);y.addEventListener(u,T),y.dispatchEvent(n),n.defaultPrevented||(!function(e,{select:t=!1}={}){const n=document.activeElement;for(const o of e)if(l(o,{select:t}),document.activeElement!==n)return}((e=d(y),e.filter(e=>"A"!==e.tagName)),{select:!0}),document.activeElement===t&&l(y))}return()=>{y.removeEventListener(u,T),setTimeout(()=>{const e=new CustomEvent(c,s);y.addEventListener(c,h),y.dispatchEvent(e),e.defaultPrevented||l(t??document.body,{select:!0}),y.removeEventListener(c,h),m.remove(F)},0)}}var e},[y,T,h,F]);const S=e.useCallback(e=>{if(!p&&!v)return;if(F.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,n=document.activeElement;if(t&&n){const t=e.currentTarget,[o,r]=function(e){const t=d(e),n=a(t,e),o=a(t.reverse(),e);return[n,o]}(t);o&&r?e.shiftKey||n!==r?e.shiftKey&&n===o&&(e.preventDefault(),p&&l(r,{select:!0})):(e.preventDefault(),p&&l(o,{select:!0})):n===t&&e.preventDefault()}},[p,v,F.paused]);return r(n.div,{tabIndex:-1,...x,ref:_,onKeyDown:S})});function d(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function a(e,t){for(const n of e)if(!f(n,{upTo:t}))return n}function f(e,{upTo:t}){if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==t&&e===t)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function l(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}i.displayName="FocusScope";var m=function(){let e=[];return{add(t){const n=e[0];t!==n&&n?.pause(),e=p(e,t),e.unshift(t)},remove(t){e=p(e,t),e[0]?.resume()}}}();function p(e,t){const n=[...e],o=n.indexOf(t);return-1!==o&&n.splice(o,1),n}export{i as FocusScope};
//# sourceMappingURL=index.mjs.js.map
