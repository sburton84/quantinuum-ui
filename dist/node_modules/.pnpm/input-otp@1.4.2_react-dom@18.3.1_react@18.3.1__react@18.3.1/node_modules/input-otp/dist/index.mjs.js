import*as e from"react";var t=Object.defineProperty,n=Object.defineProperties,r=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r;var u=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");var s=e.createContext({}),c=e.forwardRef((t,c)=>{var m,f,v,g,h,b=t,{value:w,onChange:S,maxLength:E,textAlign:y="left",pattern:P,placeholder:C,inputMode:M="numeric",onComplete:x,pushPasswordManagerStrategy:k="increase-width",pasteTransformer:T,containerClassName:R,noScriptCSSFallback:D=d,render:O,children:W}=b,j=((e,t)=>{var n={};for(var r in e)a.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&l)for(var r of l(e))t.indexOf(r)<0&&o.call(e,r)&&(n[r]=e[r]);return n})(b,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]);let[B,A]=e.useState("string"==typeof j.defaultValue?j.defaultValue:""),I=null!=w?w:B,_=function(t){let n=e.useRef();return e.useEffect(()=>{n.current=t}),n.current}(I),F=e.useCallback(e=>{null==S||S(e),A(e)},[S]),H=e.useMemo(()=>P?"string"==typeof P?new RegExp(P):P:null,[P]),L=e.useRef(null),$=e.useRef(null),N=e.useRef({value:I,onChange:F,isIOS:"undefined"!=typeof window&&(null==(f=null==(m=null==window?void 0:window.CSS)?void 0:m.supports)?void 0:f.call(m,"-webkit-touch-callout","none"))}),G=e.useRef({prev:[null==(v=L.current)?void 0:v.selectionStart,null==(g=L.current)?void 0:g.selectionEnd,null==(h=L.current)?void 0:h.selectionDirection]});e.useImperativeHandle(c,()=>L.current,[]),e.useEffect(()=>{let e=L.current,t=$.current;if(!e||!t)return;function n(){if(document.activeElement!==e)return K(null),void X(null);let t,n=e.selectionStart,r=e.selectionEnd,l=e.selectionDirection,a=e.maxLength,o=e.value,i=G.current.prev,u=-1,s=-1;if(0!==o.length&&null!==n&&null!==r){let e=n===r,l=n===o.length&&o.length<a;if(e&&!l){let e=n;if(0===e)u=0,s=1,t="forward";else if(e===a)u=e-1,s=e,t="backward";else if(a>1&&o.length>1){let n=0;if(null!==i[0]&&null!==i[1]){t=e<i[1]?"backward":"forward";let r=i[0]===i[1]&&i[0]<a;"backward"===t&&!r&&(n=-1)}u=n+e,s=n+e+1}}-1!==u&&-1!==s&&u!==s&&L.current.setSelectionRange(u,s,t)}let c=-1!==u?u:n,p=-1!==s?s:r,d=null!=t?t:l;K(c),X(p),G.current.prev=[c,p,d]}if(N.current.value!==e.value&&N.current.onChange(e.value),G.current.prev=[e.selectionStart,e.selectionEnd,e.selectionDirection],document.addEventListener("selectionchange",n,{capture:!0}),n(),document.activeElement===e&&U(!0),!document.getElementById("input-otp-style")){let e=document.createElement("style");if(e.id="input-otp-style",document.head.appendChild(e),e.sheet){let t="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";p(e.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),p(e.sheet,`[data-input-otp]:autofill { ${t} }`),p(e.sheet,`[data-input-otp]:-webkit-autofill { ${t} }`),p(e.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),p(e.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let r=()=>{t&&t.style.setProperty("--root-height",`${e.clientHeight}px`)};r();let l=new ResizeObserver(r);return l.observe(e),()=>{document.removeEventListener("selectionchange",n,{capture:!0}),l.disconnect()}},[]);let[z,V]=e.useState(!1),[q,U]=e.useState(!1),[J,K]=e.useState(null),[Q,X]=e.useState(null);e.useEffect(()=>{!function(e){setTimeout(e,0),setTimeout(e,10),setTimeout(e,50)}(()=>{var e,t,n,r;null==(e=L.current)||e.dispatchEvent(new Event("input"));let l=null==(t=L.current)?void 0:t.selectionStart,a=null==(n=L.current)?void 0:n.selectionEnd,o=null==(r=L.current)?void 0:r.selectionDirection;null!==l&&null!==a&&(K(l),X(a),G.current.prev=[l,a,o])})},[I,q]),e.useEffect(()=>{void 0!==_&&I!==_&&_.length<E&&I.length===E&&(null==x||x(I))},[E,x,_,I]);let Y=function({containerRef:t,inputRef:n,pushPasswordManagerStrategy:r,isFocused:l}){let[a,o]=e.useState(!1),[i,s]=e.useState(!1),[c,p]=e.useState(!1),d=e.useMemo(()=>"none"!==r&&("increase-width"===r||"experimental-no-flickering"===r)&&a&&i,[a,i,r]),m=e.useCallback(()=>{let e=t.current,l=n.current;if(!e||!l||c||"none"===r)return;let a=e,i=a.getBoundingClientRect().left+a.offsetWidth-18,s=a.getBoundingClientRect().top+a.offsetHeight/2;0===document.querySelectorAll(u).length&&document.elementFromPoint(i,s)===e||(o(!0),p(!0))},[t,n,c,r]);return e.useEffect(()=>{let e=t.current;if(!e||"none"===r)return;function n(){let t=window.innerWidth-e.getBoundingClientRect().right;s(t>=40)}n();let l=setInterval(n,1e3);return()=>{clearInterval(l)}},[t,r]),e.useEffect(()=>{let e=l||document.activeElement===n.current;if("none"===r||!e)return;let t=setTimeout(m,0),a=setTimeout(m,2e3),o=setTimeout(m,5e3),i=setTimeout(()=>{p(!0)},6e3);return()=>{clearTimeout(t),clearTimeout(a),clearTimeout(o),clearTimeout(i)}},[n,l,r,m]),{hasPWMBadge:a,willPushPWMBadge:d,PWM_BADGE_SPACE_WIDTH:"40px"}}({containerRef:$,inputRef:L,pushPasswordManagerStrategy:k,isFocused:q}),Z=e.useCallback(e=>{let t=e.currentTarget.value.slice(0,E);t.length>0&&H&&!H.test(t)?e.preventDefault():("string"==typeof _&&t.length<_.length&&document.dispatchEvent(new Event("selectionchange")),F(t))},[E,F,_,H]),ee=e.useCallback(()=>{var e;if(L.current){let t=Math.min(L.current.value.length,E-1),n=L.current.value.length;null==(e=L.current)||e.setSelectionRange(t,n),K(t),X(n)}U(!0)},[E]),te=e.useCallback(e=>{var t,n;let r=L.current;if(!(T||N.current.isIOS&&e.clipboardData&&r))return;let l=e.clipboardData.getData("text/plain"),a=T?T(l):l;e.preventDefault();let o=null==(t=L.current)?void 0:t.selectionStart,i=null==(n=L.current)?void 0:n.selectionEnd,u=(o!==i?I.slice(0,o)+a+I.slice(i):I.slice(0,o)+a+I.slice(o)).slice(0,E);if(u.length>0&&H&&!H.test(u))return;r.value=u,F(u);let s=Math.min(u.length,E-1),c=u.length;r.setSelectionRange(s,c),K(s),X(c)},[E,F,H,I]),ne=e.useMemo(()=>({position:"relative",cursor:j.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[j.disabled]),re=e.useMemo(()=>({position:"absolute",inset:0,width:Y.willPushPWMBadge?`calc(100% + ${Y.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:Y.willPushPWMBadge?`inset(0 ${Y.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:y,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[Y.PWM_BADGE_SPACE_WIDTH,Y.willPushPWMBadge,y]),le=e.useMemo(()=>e.createElement("input",((e,t)=>n(e,r(t)))(((e,t)=>{for(var n in t||(t={}))a.call(t,n)&&i(e,n,t[n]);if(l)for(var n of l(t))o.call(t,n)&&i(e,n,t[n]);return e})({autoComplete:j.autoComplete||"one-time-code"},j),{"data-input-otp":!0,"data-input-otp-placeholder-shown":0===I.length||void 0,"data-input-otp-mss":J,"data-input-otp-mse":Q,inputMode:M,pattern:null==H?void 0:H.source,"aria-placeholder":C,style:re,maxLength:E,value:I,ref:L,onPaste:e=>{var t;te(e),null==(t=j.onPaste)||t.call(j,e)},onChange:Z,onMouseOver:e=>{var t;V(!0),null==(t=j.onMouseOver)||t.call(j,e)},onMouseLeave:e=>{var t;V(!1),null==(t=j.onMouseLeave)||t.call(j,e)},onFocus:e=>{var t;ee(),null==(t=j.onFocus)||t.call(j,e)},onBlur:e=>{var t;U(!1),null==(t=j.onBlur)||t.call(j,e)}})),[Z,ee,te,M,re,E,Q,J,j,null==H?void 0:H.source,I]),ae=e.useMemo(()=>({slots:Array.from({length:E}).map((e,t)=>{var n;let r=q&&null!==J&&null!==Q&&(J===Q&&t===J||t>=J&&t<Q),l=void 0!==I[t]?I[t]:null;return{char:l,placeholderChar:void 0!==I[0]?null:null!=(n=null==C?void 0:C[t])?n:null,isActive:r,hasFakeCaret:r&&null===l}}),isFocused:q,isHovering:!j.disabled&&z}),[q,z,E,Q,J,j.disabled,I]),oe=e.useMemo(()=>O?O(ae):e.createElement(s.Provider,{value:ae},W),[W,ae,O]);return e.createElement(e.Fragment,null,null!==D&&e.createElement("noscript",null,e.createElement("style",null,D)),e.createElement("div",{ref:$,"data-input-otp-container":!0,style:ne,className:R},oe,e.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},le)))});function p(e,t){try{e.insertRule(t)}catch(e){console.error("input-otp could not insert CSS rule:",t)}}c.displayName="Input";var d="\n[data-input-otp] {\n  --nojs-bg: white !important;\n  --nojs-fg: black !important;\n\n  background-color: var(--nojs-bg) !important;\n  color: var(--nojs-fg) !important;\n  caret-color: var(--nojs-fg) !important;\n  letter-spacing: .25em !important;\n  text-align: center !important;\n  border: 1px solid var(--nojs-fg) !important;\n  border-radius: 4px !important;\n  width: 100% !important;\n}\n@media (prefers-color-scheme: dark) {\n  [data-input-otp] {\n    --nojs-bg: black !important;\n    --nojs-fg: white !important;\n  }\n}";export{c as OTPInput,s as OTPInputContext};
//# sourceMappingURL=index.mjs.js.map
